import{r as e}from"./react-vendor-b18ea2cb.js";import{S as t}from"./admin-features-fcd29654.js";import{z as r,I as a,J as s,K as n,N as o,O as c,Q as d,V as u,W as l,Y as i}from"./ui-vendor-ea3e37df.js";function y(e,t,f){const h=new Date;switch(e){case"today":return{start:h,end:h,prevStart:n(h,1),prevEnd:n(h,1)};case"7days":return{start:r(h,6),end:h,prevStart:r(n(h,1),6),prevEnd:n(h,1)};case"30days":return{start:r(h,29),end:h,prevStart:r(n(h,1),29),prevEnd:n(h,1)};case"4weeks":return{start:i(h,4),end:h,prevStart:i(n(h,1),4),prevEnd:n(h,1)};case"month":return{start:u(h),end:l(h),prevStart:u(n(h,1)),prevEnd:l(n(h,1))};case"quarter":return{start:c(h),end:d(h),prevStart:c(n(h,1)),prevEnd:d(n(h,1))};case"halfyear":return{start:o(h,6),end:h,prevStart:o(n(h,1),6),prevEnd:n(h,1)};case"year":return{start:a(h),end:s(h),prevStart:a(n(h,1)),prevEnd:s(n(h,1))};case"custom":if(t&&f){const e=Math.ceil((f.getTime()-t.getTime())/864e5);return{start:t,end:f,prevStart:r(t,e+365),prevEnd:r(f,365)}}return y("7days");default:return y("7days")}}function f(e,t="7days"){const r=new Date,a=new Date(r.getTime()-864e5),s=y(t),n=h(e,r,r),o=h(e,a,a),c=new Date(r.getTime()-5184e5),d=new Date(r.getFullYear(),r.getMonth(),1),u=new Date(r.getFullYear(),r.getMonth()+1,0),l=h(e,c,r),i=h(e,d,u),f=h(e,s.start,s.end),p=h(e,s.prevStart,s.prevEnd);return{todaySales:n,yesterdaySales:o,weekSales:l,monthSales:i,currentPeriodSales:f,lastYearPeriodSales:p,growth:o>0?(n-o)/o*100:0,yoyGrowth:0!==p?(f-p)/Math.abs(p)*100:f>0?1/0:0,totalTreatments:e.reduce((e,t)=>e+(t.treatments_count||0),0),avgDaily:e.length>0?e.reduce((e,t)=>e+t.daily_sales,0)/e.length:0,timeframeLabel:m(t)}}function h(e,t,r){return e.filter(e=>{const a=new Date(e.date);return n=r,(s=a)>=t&&s<=n;var s,n}).reduce((e,t)=>e+t.daily_sales,0)}function m(e){switch(e){case"today":return"Today";case"7days":return"Last 7 Days";case"30days":return"Last 30 Days";case"4weeks":return"Last 4 Weeks";case"month":return"This Month";case"quarter":return"This Quarter";case"halfyear":return"Last 6 Months";case"year":return"This Year";case"custom":return"Custom Period";default:return"Current Period"}}function p(r={}){const{selectedLocation:a="all",userLocation:s,isAdmin:n=!1,timeframe:o="7days"}=r,[c,d]=e.useState([]),[u,l]=e.useState(!0),[i,y]=e.useState(null);e.useEffect(()=>{h()},[a]);const h=async()=>{l(!0),y(null);try{const e=function(e,t,r,a=!1){if("all"===t&&a)return e;const s="all"!==t?t:r;return e.filter(e=>e.location===s)}(await t.list(),a,s,n);d(e)}catch(e){y(e instanceof Error?e.message:"Failed to load sales data"),d([])}finally{l(!1)}};return{salesData:c,stats:f(c,o),loading:u,error:i,refetch:h,createSalesRecord:async e=>{try{await t.create(e),await h()}catch(r){throw new Error(r instanceof Error?r.message:"Failed to create sales record")}},updateSalesRecord:async(e,r)=>{try{await t.update(e,r),await h()}catch(a){throw new Error(a instanceof Error?a.message:"Failed to update sales record")}},deleteSalesRecord:async e=>{try{await t.delete(e),await h()}catch(r){throw new Error(r instanceof Error?r.message:"Failed to delete sales record")}}}}export{p as u};
//# sourceMappingURL=useSalesData-329b0fde.js.map
